version: '3.8'
services:
  mongo:
    image: mongo
    restart: always
    expose:
      - 27017
    ports:
      - 27017:27017
    environment:
      MONGO_INITDB_ROOT_USERNAME: ${MONGO_INITDB_ROOT_USERNAME:-root}
      MONGO_INITDB_ROOT_PASSWORD: ${MONGO_INITDB_ROOT_PASSWORD:-password}
  message-broker:
    build:
      context: .
      dockerfile: ./message-broker/Dockerfile
    image: guardian-message-broker
    ports:
      - 3003:3003
    expose:
      - 7500
  ui-service:
    build:
      context: .
      dockerfile: ./ui-service/Dockerfile
    image: guardian-ui-service
    ports:
      - 3002:3002
    environment:
      DB_USER: ${MONGO_INITDB_ROOT_USERNAME:-root}
      DB_PASSWORD: ${MONGO_INITDB_ROOT_PASSWORD:-password}
    depends_on:
      - mongo
      - message-broker
      - guardian-service
  guardian-service:
    build:
      context: .
      dockerfile: ./guardian-service/Dockerfile
    image: guardian-service
    ports:
      - 3001:3001
    environment:
      DB_USER: ${MONGO_INITDB_ROOT_USERNAME:-root}
      DB_PASSWORD: ${MONGO_INITDB_ROOT_PASSWORD:-password}
    depends_on:
      - mongo
      - message-broker
  mrv-sender:
    build:
      context: .
      dockerfile: ./mrv-sender/Dockerfile
    image: guardian-mrv-sender
    ports:
      - 3005:3005
volumes:
  mongo:
  # volume-guardian-service:
  # volume-ui-service:
  # volume-mrv-sender:
#  volume-message-broker:
